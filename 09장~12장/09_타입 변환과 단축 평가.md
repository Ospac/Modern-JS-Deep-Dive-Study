# 09장 타입 변환과 단축 평가

## 9.1 타입 변환이란?
- **명시적 타입 변환**<sup>explicit coercion</sup> 혹은 타입 캐스팅<sup>type casting</sup> : 개발자가 의도적으로 값의 타입을 변환하는 것
- **암묵적 타입 변환**<sup>implicit coercion</sup> 혹은 타입 강제 변환<sup>type coercion</sup> : 자바스크립트 엔진에 의해 암묵적으로 타입을 변환 되는 것을 
    - 기존 변수 값을 재할당하거나 변경하지 않는다. 
```js
var x = 10; 
var str = x + ''; // 암묵적 타입 변환, x는 그대로 number type, x를 변환한 '10'을 새로 생성한다.
```
## 9.2 암묵적 타입 변환
#### 9.2.1. 문자열 타입으로 변환 
`+` 연산자는 피연산자 중 하나 이상이 문자열이면 `문자열 연결 연산자`이며, 모든 피연산자를 문자열 타입으로 암묵적 타입 변환한다.
```js
1 + '2' // -> '12'
```
#### 9.2.2. 숫자 타입으로 변환
**산술 연산자**의 피연산자는 숫자 타입으로 암묵적 타입 변환한다. 변환할 수 없는 경우 `NaN`으로 평가된다.

```js
1 - '1'   // -> 0
1 * '10'  // -> 10
1 / 'one' // -> NaN
```

**비교 연산자**의 경우, 피연산자가 둘다 문자열인 경우, 알파벳 순서에 따라 크기를 비교하지만, 그 이외에 경우에는 숫자 타입으로 암묵적 타입 변환한다.
```js
'1' > 0 // -> true
'9' > '10' // -> true
```
**+ 단항 연산자**의 경우, 피연산자를 숫자 타입으로 변환한다.
```js
+''       // -> 0
+'1'      // -> 1

+null     // -> 0
+undefined // -> NaN

+{}             // -> NaN
+[]             // -> 0
+[10, 20]       // -> NaN
```

#### 9.2.3. 불리언 타입으로 변환
if 문, for 문, 삼함 조건 연산자의 조건식은 불리언 타입으로 암묵적 타입 변환된다.
자바스크립트의 값들은 그 변환 결과에 따라, **Truthy**, **Falsy** 둘로 나뉜다.
##### Falsy
- false
- undefined
- null
- 0, -0
- NaN
- ''
이 외에는 모두 Truthy이다.

## 9.3 명시적 타입 변환
- 생성자 함수를 new 연산자 없이 호출하는 방법
- 빌트인 메서드를 활용하는 방법
```js
// String 생성자 함수
String(1);

//Object.prototype.toString
(1).toString();
```
```js
//Number 생성자 함수
Number('1');

//parseInt, parseFloat (문자열만 변환 가능)
parseInt('0');
parseFloat('10.53');
```
```js
//Boolean 생성자 함수
Boolean('x')

// ! 부정 논리 연산자 두 번 사용
!!'x'
```
## 9.4 단축 평가
#### 9.4.1 논리 연산자를 사용한 단축 평가
논리곱 `&&`, 논리합 `||` 연산자는 **단축평가**<sup>short-circuit evaluation</sup>를 수행한다. 
- 두 피연산자를 평가하는 도중에 결과가 확정된 경우 나머지 평가를 생략한다.
- 논리 연산의 결과를 결정하는 피연산자를 타입 변환하지 않고 그대로 반환한다.

##### 단축평가를 이용하여 `if문`을 대체할 수 있다.
```js
// done이 true라면 message에 '완료'를 할당
var done = true;
var message = done && '완료'; // 완료
```
```js
// done이 false라면 message에 '미완료'를 할당
var done = false;
var message = done || '미완료'; // 미완료
```

##### `null`, `undefined`가 될 수 있는 객체에 대한 타입가드를 수행할 수 있다.
```js
var elem = null;
var value = elem && elem.value; // elem이 존재할 경우에만 elem.value 할당
```
#### 9.4.2 옵셔널 체이닝 연산자
ES11에서 도입된 **옵셔널 체이닝**<sup>optional chaining</sup> 연산자 `?`
좌항의 피연산자가 `null` 또는 `undefined`인 경우 `undefined`를 반환하고, 그렇지 않으면 우항의 프로퍼티 참조를 한다.
주의해야할 점은 좌항이 `falsy`라도 `null`, `undefined`가 아니면 프로퍼티 참조를 한다는 것이다.

```js
var value = elem?.value;

// falsy
var str = '';
console.log(str?.length); // 0
```
#### 9.4.3 null 병합 연산자
ES11에서 도입된 **null 병합**<sup>nullish coalescing</sup> 연산자
좌항이 `null` 또는 `undefined`인 경우 우항을 반환하고, 그렇지 않으면 좌항을 반환한다.

기존 논리합 연산자(`||`)를 이용한 기본값 설정 방식의 결함을 보완할 수 있다.
```js
// ''은 falsy라서 default로 기본값이 설정되지만, ''이 들어가는 것이 의도한 코드일 수 있다.
var foo = '' || 'default';
console.log(foo); // 'default'
```
반면, null 병합 연산자는 `nullish`여부만 판단하기 때문에 의도한 대로 동작한다.
```js
var foo = '' ?? 'default';
console.log(foo); // 'default'
```